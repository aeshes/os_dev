### Сборка загрузчика
nasm -f bin boot.asm -o boot.bin

#### Опции NASM
- **-f** указывает NASM, какого типа программи сгенерировать
- **-o** задает имя создаваемого файла

## Теория загрузчиков
Характеристики загрузчиков:
- Хранятся в Master Boot Record (MBR)
- Находятся в первом секторе диска
- Размер загрузчика равен размеру сектора (512 байт)
- Загружаются прерыванием `19h` BIOS по адресу `0x7C00`

## Процесс загрузки

### Нажатие кнопки питания.
По проводам от кнопки сигнал подается материнской плате. Материнская плата просто перенаправляет сигнал блоку питания. Когда блок питания получает активный сигнал, он начинает подавать напряжение в остальную систему. Затем блок питания подает сигнал `power_good` в BIOS материнской платы.

### BIOS POST
Когда BIOS получает сигнал `power_good`, он инициирует процесс Power on Self Test (POST). В этом процессе проверяется, что питания достаточно, и что все устройства и память работают.

Затем POST передает управление BIOS. POST копирует BIOS в конец памяти (например, по адресу 0xFFFFF0) и вставляет инструкцию перехода в первый байт памяти.

Указатель инструкций `CS:IP` устанавливается значением 0 и процессор получает управление.

Процессор начинает выполнение с адреса 0. Здесь находится инструкция перехода. Она передает управление на адрес 0xFFFFF0 (или в другое место, куда загружен BIOS) и процессор начинает выполнять BIOS.

### BIOS
BIOS выполняет разные функции. Он создает таблицу векторов прерываний (IVT) и предоставляет некоторые базовые сервисы прерываний. BIOS так же тестирует оборудование и предоставляет тулзу для настройки.

Затем BIOS должен найти операционную систему. Основываясь на порядке загрузки в BIOS Setup, BIOS выполняет прерывание 0x19, чтобы найти загрузочное устройство.

### Прерывания
Прерывание это подпрограмма, которая может выполняться другими программами. Эти прерывания хранятся по адресу 0 в таблице векторов прерываний.

Использование снесуществующих прерываний крашнет программу.

Если изменить режим работы процессора, таблица вектором прерываний не будет доступна. Это значит, что никакие прерывания - ни программные, ни аппаратные - не будут доступны, ни даже прерывания BIOS.

### Прерывание 0x19
Это прерывание выполняется BIOS. Оно читает первый сектор жесткого диска и находит загрузчик по магическим байтам `0xAA55` (511 и 512 байты). Если диск загрузочный, это прерывание загружает загрузочный сектор по адресу `0x7C00` и передает туда управление.

Загрузчик всегда загружен по адресу `0x7C00`.